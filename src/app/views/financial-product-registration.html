<bk-layout-main [title]="'Product registration'" xmlns="http://www.w3.org/1999/html">


    <div class="row">
        <div class="col-md-12">
            <div class="portlet light portlet-fit bordered">
                <div class="portlet-body">

                    <div class="mt-element-step">

                        <div class="row step-line">
                            <div class="col-md-3 mt-step-col first" [class.done]="step > 1" [class.active]="step == 1" (click)="stepClick(1)" [class.can-activate]="canActivateStep(1)">
                                <div class="mt-step-number bg-white font-grey">
                                    <i class="fa fa-bars"></i>
                                </div>
                                <div class="mt-step-title uppercase font-grey-cascade">Tariffs</div>
                                <div class="mt-step-content font-grey-cascade">Select a right tariffs</div>
                            </div>
                            <div class="col-md-3 mt-step-col" [class.done]="step > 2" [class.active]="step == 2" (click)="stepClick(2)" [class.can-activate]="canActivateStep(2)">
                                <div class="mt-step-number bg-white font-grey">
                                    <i class="fa fa-archive"></i>
                                </div>
                                <div class="mt-step-title uppercase font-grey-cascade">Packages</div>
                                <div class="mt-step-content font-grey-cascade">Choose an expansions</div>
                            </div>
                            <div class="col-md-3 mt-step-col" [class.done]="step > 3" [class.active]="step == 3" (click)="stepClick(3)" [class.can-activate]="canActivateStep(3)">
                                <div class="mt-step-number bg-white font-grey">
                                    <i class="fa fa-pencil-square-o"></i>
                                </div>
                                <div class="mt-step-title uppercase font-grey-cascade">Registration info</div>
                                <div class="mt-step-content font-grey-cascade">Fill the necessary info</div>
                            </div>
                            <div class="col-md-3 mt-step-col last" [class.done]="step > 4" [class.active]="step == 4" (click)="stepClick(4)" [class.can-activate]="canActivateStep(4)">
                                <div class="mt-step-number bg-white font-grey">
                                    <i class="fa fa-flag-checkered"></i>
                                </div>
                                <div class="mt-step-title uppercase font-grey-cascade">Summary</div>
                                <div class="mt-step-content font-grey-cascade">Check your order and confirm</div>
                            </div>
                        </div>

                    </div>

                </div>
            </div>
        </div>
    </div>


    <div *ngIf="step===1">

        <div class="portlet light portlet-fit bordered">
            <div class="portlet-title">
                <div class="becki-caption">
                    <span class="font-blue-dark uppercase">
                        <i class="fa fa-fw fa-bars"></i>
                        Tariffs
                    </span>
                </div>
            </div>
            <div class="portlet-body">
                <div class="pricing-content-1">
                    <div class="row">
                        <div *ngFor="let tariff of tariffs" class="col-md-3">
                            <div class="price-column-container border-active tariff">
                                <div class="price-table-head bg-{{tariff.color|lowercase}}">
                                    <h2 class="no-margin">{{tariff.tariff_name}}</h2>
                                </div>
                                <div class="arrow-down border-top-{{tariff.color|lowercase}}"></div>

                                <div class="price-table-pricing">
                                    <h3 style="line-height: 50px;" [style.font-size]="makePrice(tariff.price.USD).length>=7?'40px':'50px'">{{makePrice(tariff.price.USD)}}</h3>
                                    <p class="font-grey-salt">Average monthly cost</p>
                                    <div *ngIf="tariff == selectedTariff" class="price-ribbon">Selected</div>
                                </div>
                                <div class="price-table-content">
                                    <div *ngFor="let label of tariff.labels" class="line">
                                        <i class="fa fa-fw {{label.icon|lowercase}} font-{{tariff.color|lowercase}}"></i>
                                        {{label.label}}
                                    </div>
                                </div>
                                <div class="arrow-down arrow-grey"></div>
                                <div class="price-table-footer">
                                    <button type="button" (click)="chooseTariff(tariff)" class="btn uppercase price-button {{tariff.color|lowercase}}">
                                        Select
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="step===2">
        <div class="portlet light portlet-fit bordered">
            <div class="portlet-title">
                <div class="becki-caption">
                    <span class="font-blue-dark uppercase">
                        <i class="fa fa-fw fa-archive"></i>
                        Packages
                    </span>
                </div>
            </div>
            <div class="portlet-body">
                <div class="pricing-content-1">
                    <div class="row">
                        <div *ngIf="selectedTariff.extensions_included || selectedTariff.extensions_optional">
                            <div *ngIf="selectedTariff.extensions_included.length==0 || selectedTariff.extensions_optional.length==0">
                                <h3 class="text-center margin-bottom-15">There is no expansions packages, click Continue.</h3>
                            </div>
                        </div>

                        <div *ngFor="let package of selectedTariff.extensions_included" class="col-md-3 margin-bottom-15">
                            <div [class.border-red-mint]="selectedExtensions.indexOf(package) > -1" class="price-column-container border-active package">
                                <div class="price-table-head bg-{{package.color|lowercase}}">
                                    <h4 class="no-margin">{{package.name}}</h4>
                                </div>
                                <div class="arrow-down border-top-{{package.color|lowercase}}"></div>
                                <div class="price-table-pricing">
                                    <h3 style="font-size: 50px; line-height: 50px;">Free</h3>
                                    <p class="font-grey-salt">Average monthly cost</p>
                                    <div class="price-ribbon">Included</div>
                                </div>
                                <div class="price-table-content">
                                    <div *ngFor="let label of package.labels" class="line">
                                        <i class="fa fa-fw {{label.icon|lowercase}} font-{{package.color|lowercase}}"></i>
                                        {{label.label}}
                                    </div>
                                </div>
                                <div class="arrow-down arrow-grey"></div>
                                <div class="price-table-footer">
                                    <button type="button" class="btn grey-salsa btn-outline uppercase price-button" disabled="disabled">
                                        Included
                                    </button>
                                </div>
                            </div>
                        </div>

                        <div *ngFor="let package of selectedTariff.extensions_optional" class="col-md-3 margin-bottom-15">
                            <div class="price-column-container border-active package">
                                <div class="price-table-head bg-{{package.color|lowercase}}">
                                    <h4 class="no-margin">{{package.name}}</h4>
                                </div>
                                <div class="arrow-down border-top-{{package.color|lowercase}}"></div>
                                <div class="price-table-pricing">
                                    <h3 style="line-height: 50px;" [style.font-size]="makePrice(package.price.USD).length>=7?'40px':'50px'">{{makePrice(package.price.USD)}}</h3>
                                    <p class="font-grey-salt">Average monthly cost</p>
                                    <div class="price-ribbon" *ngIf="selectedExtensions.indexOf(package) > -1">Included</div>
                                </div>
                                <div class="price-table-content">
                                    <div *ngFor="let label of package.labels" class="line">
                                        <i class="fa fa-fw {{label.icon|lowercase}} font-{{package.color|lowercase}}"></i>
                                        {{label.label}}
                                    </div>
                                </div>
                                <div class="arrow-down arrow-grey"></div>
                                <div class="price-table-footer">
                                    <button type="button" *ngIf="selectedExtensions.indexOf(package) == -1" class="btn green-jungle uppercase price-button" (click)="addExtension(package)">
                                        Add
                                    </button>
                                    <button type="button" *ngIf="selectedExtensions.indexOf(package) > -1" class="btn red uppercase price-button" (click)="removeExtension(package)">
                                        Remove
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-12 text-center">
                            <div class="btn-group btn-group-solid">
                                <button type="button" class="btn grey-salsa btn-lg btn-outline" (click)="stepClick(1)">
                                    Back
                                </button>
                                <button type="button" class="btn green-jungle btn-lg" (click)="stepClick(3)">
                                    Continue
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="step===3">
        <form *ngIf="form" [formGroup]="form">
            <div class="portlet light portlet-fit bordered">
                <div class="portlet-title">
                    <div class="becki-caption">
                        <span class="font-blue-dark uppercase">
                            <i class="fa fa-fw fa-pencil-square-o"></i>
                            Registration info
                        </span>
                    </div>
                </div>
                <div class="row portlet-body">


                    <div class="col-md-6">

                        <div class="portlet box blue-dark">
                            <div class="portlet-title">
                                <div class="caption">
                                    <i class="fa fa-fw fa-lg fa-info"></i>Product info
                                </div>
                            </div>
                            <div class="portlet-body">
                                <bk-form-input [control]="form.controls.product_individual_name" label="Product name (Your unique name for this tariff order)"></bk-form-input>
                            </div>
                        </div>

                        <div class="portlet box blue-dark">
                            <div class="portlet-title">
                                <div class="caption">
                                    <i class="fa fa-fw fa-lg fa-credit-card"></i>Billing info
                                </div>
                            </div>
                            <div class="portlet-body">
                                <bk-form-input [control]="form.controls.invoice_email" type="email" label="Invoice e-mail"></bk-form-input>

                                <bk-form-select *ngIf="form.controls.payment_method" [control]="form.controls.payment_method" label="Payment method" [options]="optionsPaymentMethod"></bk-form-select>
                                <bk-form-select *ngIf="form.controls.payment_mode" [control]="form.controls.payment_mode" label="Payment mode" [options]="optionsPaymentMode"></bk-form-select>
                            </div>
                        </div>

                    </div>

                    <div class="col-md-6">

                        <div class="portlet box blue-dark">
                            <div class="portlet-title">
                                <div class="caption" *ngIf="!selectedTariff.company_details_required">
                                    <i class="fa fa-fw fa-lg fa-user"></i>Personal info
                                </div>
                                <div class="caption" *ngIf="selectedTariff.company_details_required">
                                    <i class="fa fa-fw fa-lg fa-building"></i>Company info
                                </div>
                            </div>
                            <div class="portlet-body">

                                <bk-form-input *ngIf="form.controls.full_name" [control]="form.controls.full_name" label="Full name"></bk-form-input>
                                <bk-form-input *ngIf="form.controls.company_name" [control]="form.controls.company_name" label="Company name"></bk-form-input>

                                <bk-form-input [control]="form.controls.street" label="Street"></bk-form-input>
                                <bk-form-input [control]="form.controls.street_number" label="Street number"></bk-form-input>
                                <bk-form-input [control]="form.controls.city" label="City"></bk-form-input>
                                <bk-form-input [control]="form.controls.zip_code" label="Zip code"></bk-form-input>
                                <bk-form-select (change)="checkInEu()" [control]="form.controls.country" label="Country" [options]="optionsCountryList"></bk-form-select>

                                <bk-form-input *ngIf="form.controls.registration_no && !inEu" [control]="form.controls.registration_no" label="Registration number"></bk-form-input>
                                <bk-form-input *ngIf="form.controls.vat_number && inEu" [control]="form.controls.vat_number" label="VAT number (with with country code)"></bk-form-input> <!--TODO předělat if na Model-Change -->

                                <bk-form-input *ngIf="form.controls.company_web" [control]="form.controls.company_web" type="url" label="Company web"></bk-form-input>
                                <bk-form-input *ngIf="form.controls.company_authorized_email" [control]="form.controls.company_authorized_email" type="email" label="Company authorized contact e-mail"></bk-form-input>
                                <bk-form-input *ngIf="form.controls.company_authorized_phone" [control]="form.controls.company_authorized_phone" type="tel" label="Company authorized contact phone"></bk-form-input>

                            </div>
                        </div>

                    </div>

                    <div class="row">
                        <div class="col-md-12 text-center">
                            <div class="btn-group btn-group-solid">
                                <button type="button" class="btn grey-salsa btn-lg btn-outline" (click)="stepClick(2)">
                                    Back
                                </button>
                                <button type="button" class="btn green-jungle btn-lg" (click)="stepClickElseTouchForm(4)">
                                    Continue
                                </button>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
        </form>

    </div>

    <div *ngIf="step===4">


        <div class="portlet light portlet-fit bordered">
            <div class="portlet-title">
                <div class="becki-caption">
                        <span class="font-blue-dark uppercase">
                            <i class="fa fa-fw fa-flag-checkered"></i>
                            Summary
                        </span>
                </div>
            </div>
            <div class="row portlet-body">

                <div class="col-md-6">

                    <div class="portlet box blue-dark">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-fw fa-lg fa-pencil-square-o"></i>Registration info
                            </div>
                            <div class="actions">
                                <a (click)="stepClick(3)" class="btn btn-default btn-sm">
                                    <i class="fa fa-fw fa-pencil-square-o"></i> Edit
                                </a>
                            </div>
                        </div>
                        <div class="portlet-body">


                            <table class="table table-hover no-margin">
                                <tbody>
                                    <tr>
                                        <td class="no-border-top" colspan="2"><strong> Product info </strong></td>
                                    </tr>
                                    <tr>
                                        <td> Product name: </td><td> {{form.controls["product_individual_name"].value}} </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2"><strong> Billing info </strong></td>
                                    </tr>

                                    <tr>
                                        <td> Invoice e-mail: </td><td> {{form.controls["invoice_email"].value}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.payment_method">
                                        <td> Payment method: </td><td> {{translatePaymentMethod(form.controls["payment_method"].value)}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.payment_mode">
                                        <td> Payment mode: </td><td> {{translatePaymentMode(form.controls["payment_mode"].value)}} </td>
                                    </tr>

                                    <tr *ngIf="!selectedTariff.company_details_required">
                                        <td colspan="2"><strong> Personal info </strong></td>
                                    </tr>
                                    <tr *ngIf="selectedTariff.company_details_required">
                                        <td colspan="2"><strong> Company info </strong></td>
                                    </tr>

                                    <tr *ngIf="form.controls.full_name">
                                        <td> Full name: </td><td> {{form.controls["full_name"].value}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.company_name">
                                        <td> Company name: </td><td> {{form.controls["company_name"].value}} </td>
                                    </tr>

                                    <tr>
                                        <td> Street: </td><td> {{form.controls["street"].value}} </td>
                                    </tr>
                                    <tr>
                                        <td> Street number: </td><td> {{form.controls["street_number"].value}} </td>
                                    </tr>
                                    <tr>
                                        <td> City: </td><td> {{form.controls["city"].value}} </td>
                                    </tr>
                                    <tr>
                                        <td> Zip code: </td><td> {{form.controls["zip_code"].value}} </td>
                                    </tr>
                                    <tr>
                                        <td> Country: </td><td> {{form.controls["country"].value}} </td>
                                    </tr>

                                    <tr *ngIf="form.controls.registration_no && !inEu">
                                        <td> Registration number: </td><td> {{form.controls["registration_no"].value}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.vat_number && inEu">
                                        <td> VAT number: </td><td> {{form.controls["vat_number"].value}} </td>
                                    </tr>

                                    <tr *ngIf="form.controls.company_web">
                                        <td> Company web: </td><td> {{form.controls["company_web"].value}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.company_authorized_email">
                                        <td> Company authorized contact e-mail: </td><td> {{form.controls["company_authorized_email"].value}} </td>
                                    </tr>
                                    <tr *ngIf="form.controls.company_authorized_phone">
                                        <td> Company authorized contact phone: </td><td> {{form.controls["company_authorized_phone"].value}} </td>
                                    </tr>
                                </tbody>
                            </table>

                        </div>
                    </div>

                </div>

                <div class="col-md-6">

                    <div class="portlet box blue-dark">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-fw fa-lg fa-pencil-square-o"></i>Your product
                            </div>
                        </div>
                        <div class="portlet-body">


                            <table class="table table-hover no-margin">
                                <tbody>

                                    <tr>
                                        <td class="no-border-top"><strong> Tariff </strong></td>
                                        <td class="no-border-top"><strong> Description </strong></td>
                                        <td class="no-border-top text-center"><strong> Price </strong></td>
                                    </tr>

                                    <tr>
                                        <td> {{selectedTariff.tariff_name}} </td>
                                        <td> {{selectedTariff.tariff_description}} </td>
                                        <td class="text-center"> {{makePrice(selectedTariff.price.USD)}} </td>
                                    </tr>

                                    <tr *ngIf="selectedTariff.extensions_included.length || selectedExtensions.length">
                                        <td colspan="3"><strong> Packages </strong></td>
                                    </tr>
                                    <tr *ngFor="let package of selectedTariff.extensions_included">
                                        <td> {{package.name}} </td>
                                        <td> {{package.description}} </td>
                                        <td class="text-center"> Free </td>
                                    </tr>
                                    <tr *ngFor="let package of selectedExtensions">
                                        <td> {{package.name}} </td>
                                        <td> {{package.description}} </td>
                                        <td class="text-center"> {{makePrice(package.price.USD)}} </td>
                                    </tr>

                                    <tr>
                                        <td colspan="2"><strong> Total </strong></td>
                                        <td class="text-center"><strong> {{makePrice(getTotalPrice())}} </strong></td>
                                    </tr>

                                </tbody>
                            </table>

                        </div>
                    </div>

                </div>

                <div class="row">
                    <div class="col-md-12 text-center">
                        <div class="btn-group btn-group-solid">
                            <button type="button" class="btn grey-salsa btn-lg btn-outline" (click)="stepClick(3)">
                                Back
                            </button>
                            <button type="button" class="btn green-jungle btn-lg" (click)="onConfirmClick()">
                                Confirm
                            </button>
                        </div>
                    </div>
                </div>

            </div>
        </div>


    </div>

</bk-layout-main>
