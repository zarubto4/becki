<!--
  ~ Â© 2016 Becki Authors. See the AUTHORS file found in the top-level directory
  ~ of this distribution.
  -->

<template data-bind-ngIf="!readonly">
  <div class="row">
    <div class="col-xs-12">
      <div class="btn-toolbar">
        <div class="btn-group btn-group-xs">
          <div class="btn-group btn-group-xs dropdown">
            <button type="button" class="btn btn-default dropdown-toggle">
              Add <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a data-on-click="onAddPathClick($event)" style="cursor: pointer">File</a></li>
              <template data-bind-ngIf="canAddLibraries()">
                <li><a data-on-click="onAddLibraryClick($event)" style="cursor: pointer">Library</a></li>
              </template>
            </ul>
          </div>
          <button class="btn btn-default" type="button" data-bind-disabled="selection?.type != 'path'" data-on-click="onMoveClick($event)">Move</button>
          <button class="btn btn-danger" type="button" data-bind-disabled="!selection" data-on-click="onRemoveClick($event)">Remove</button>
        </div>
        <div class="btn-group btn-group-xs pull-right">
          <button type="button" class="btn btn-default" data-bind-disabled="!buildTarget" data-bind-title="buildTarget ? '' : 'Target device is not known.'" data-on-click="onBuildClick($event)">Build</button>
        </div>
      </div>
    </div>
  </div>
</template>
<div class="row">
  <div class="col-xs-12" data-bind-class.col-sm-4="selection?.type == 'path' && files.hasOwnProperty(selection?.value)">
    <div class="form-control" style="height: 200px; overflow: auto; white-space: nowrap;">
      <table class="table table-treegrid">
        <tbody>
          <tr>
            <td class="treegrid-node" style="border: 0px">
              <span class="icon expand-icon fa"></span>
              <span class="icon node-icon fa fa-files-o"></span>
              Files
            </td>
          </tr>
          <tr data-bind-class.odd="selection?.type == 'path' && path == selection?.value" data-bind-class.hidden="isPathHidden(path)" template="ngFor let path of getPaths(true)">
            <td class="treegrid-node" data-on-click="onPathClick(path, $event)" style="border: 0px; cursor:pointer">
              <span class="indent" template="ngFor let parent of convertPathToPaths(path)"></span>
              <span class="icon expand-icon fa {{isPathExpanded(path) == null ? '' : isPathExpanded(path) ? 'fa-angle-down' : 'fa-angle-right'}}"></span>
              <span class="icon node-icon fa {{files.hasOwnProperty(path) ? 'fa-file-o' : 'fa-folder'}}"></span>
              {{getPathBasename(path)}}
            </td>
          </tr>
          <tr>
            <td class="treegrid-node" style="border: 0px">
              <span class="icon expand-icon fa"></span>
              <span class="icon node-icon fa fa-book"></span>
              Libraries
            </td>
          </tr>
          <tr data-bind-class.odd="selection?.type == 'library' && library == selection?.value" template="ngFor let library of getLibraries(true)">
            <td class="treegrid-node" data-on-click="onLibraryClick(library, $event)" style="border: 0px; cursor:pointer">
              <span class="indent"></span>
              <span class="icon expand-icon fa"></span>
              <span class="icon node-icon fa fa-book"></span>
              {{library}}
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
  <template data-bind-ngIf="selection?.type == 'path' && files.hasOwnProperty(selection?.value)">
    <div class="col-sm-8">
      <div data-bindon-fieldCode="files[selection.value]" data-bind-mode="'ace/mode/c_cpp'" data-bind-readonly="readonly" data-bind-annotations="filesAnnotations[selection.value] || []">
        <div class="spinner"></div>
      </div>
    </div>
  </template>
</div>
