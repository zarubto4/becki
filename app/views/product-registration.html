<layout-main [title]="'Product registration'">


    <div class="row">
        <div class="col-md-12">
            <div class="portlet light portlet-fit bordered">
                <div class="portlet-body">
                    <div class="mt-element-step">
                        <div class="row step-thin">
                            <div class="mt-step-desc">
                                <div class="font-dark bold uppercase">Step by step</div>
                                <div class="caption-desc font-grey-cascade">Confirm a product purchase</div>
                                <br></div>
                            <div class="col-md-3 bg-grey mt-step-col" (click)="stepClick(1,true)"
                                 (mouseenter)="activeClass['1'] = true" (mouseleave)="activeClass['1'] = false"
                                 [class.active]="activeClass['1']" [class.done]="step == 1">
                                <div class="mt-step-number bg-white font-grey">1</div>
                                <div class="mt-step-title uppercase font-grey-cascade">Choose</div>
                                <div class="mt-step-content font-grey-cascade">Choose a right product</div>
                            </div>
                            <div class="col-md-3 bg-grey mt-step-col " (click)="stepClick(2,true)"
                                 (mouseenter)="activeClass['2'] = true" (mouseleave)="activeClass['2'] = false"
                                 [class.active]="activeClass['2']" [class.done]="step == 2">
                                <div class="mt-step-number bg-white font-grey">2</div>
                                <div class="mt-step-title uppercase font-grey-cascade">Register</div>
                                <div class="mt-step-content font-grey-cascade">Fill the necessary info</div>
                            </div>
                            <div class="col-md-3 bg-grey mt-step-col " (click)="stepClick(3,true)"
                                 (mouseenter)="activeClass['3'] = true" (mouseleave)="activeClass['3'] = false"
                                 [class.active]="activeClass['3']" [class.done]="step == 3">
                                <div class="mt-step-number bg-white font-grey">3</div>
                                <div class="mt-step-title uppercase font-grey-cascade">Packages</div>
                                <div class="mt-step-content font-grey-cascade">Choose an expansions</div>
                            </div>
                            <div class="col-md-3 bg-grey mt-step-col " (click)="stepClick(4,true)"
                                 (mouseenter)="activeClass['4'] = true" (mouseleave)="activeClass['4'] = false"
                                 [class.active]="activeClass['4']" [class.done]="step == 4">
                                <div class="mt-step-number bg-white font-grey">4</div>
                                <div class="mt-step-title uppercase font-grey-cascade">Deploy</div>
                                <div class="mt-step-content font-grey-cascade">start using a product</div>
                            </div>
                        </div>
                        <br>
                        <br>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div *ngIf="step===1">

        <div class="portlet light portlet-fit bordered">
            <div class="portlet-title">
                <div class="caption">
                    <i class="icon-share font-green"></i>
                    <span class="caption-subject font-green bold uppercase">Avalible tariffs</span>
                </div>
            </div>
            <div class="portlet-body">
                <div class="pricing-content-1">
                    <div class="row">
                        <div *ngFor="let tariff of tariffForRegistration" class="col-md-3">
                            <div class="price-column-container border-active">
                                <div class="price-table-head bg-{{tariff.color| lowercase}}">
                                    <h2 class="no-margin">{{tariff.tariff_name}}</h2>
                                </div>
                                <div class="arrow-down border-top-{{tariff.color| lowercase}}"></div>

                                <div class="price-table-pricing">
                                    <h4 style="margin: 0 10px; color: gray;" class="pull-right">{{tariff.price.USD}}<span class="becki-payment-secondary price-sign" >$</span></h4>
                                    <h4 style="margin: 0 10px;color: gray;" class="pull-left">{{tariff.price.CZK}}<span class="becki-payment-secondary price-sign">CZK</span></h4>
                                    <h3 style="clear: both;padding-top: 10px;"><span class="price-sign">€</span>{{tariff.price.EUR}}</h3> <!-- TODO price selector-->
                                    <p>per month</p>
                                </div>
                                <div class="price-table-content">
                                    <div *ngFor="let label of tariff.labels" class="row mobile-padding">
                                        <div class="col-xs-3 text-right mobile-padding">
                                            <i class="fa {{label.icon| lowercase}}"></i>
                                        </div>
                                        <div class="col-xs-9 text-left mobile-padding">{{label.label}}</div>
                                        <!-- TODO zobrazit Description, metronic tooltips s data-content vyhazuje error -->
                                    </div>

                                </div>
                                <div class="arrow-down arrow-grey"></div>
                                <div class="price-table-footer">
                                    <button type="button" (click)="chooseTariff(tariff)"
                                            class="btn grey-salsa btn-outline sbold uppercase price-button">Sign Up
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="step===2">
        <form *ngIf="form" [formGroup]="form">
            <div class="portlet light portlet-fit bordered">
                <div class="portlet-title">
                    <div class="caption">
                        <i class="icon-share font-green"></i>
                        <span class="caption-subject font-green bold uppercase">fill the Tariff info</span>
                    </div>
                </div>
                <div class="row portlet-body">
                    <div class="pricing-content-1">
                        <div [class.col-md-6]="selectedTariff.company_details_required">
                            <becki-form-input [control]="form.controls.city" label="City"></becki-form-input>
                            <becki-form-select [control]="form.controls.country" label="Country"
                                               [options]="countryList"></becki-form-select>
                            <becki-form-select [control]="form.controls.currency_type" label="Currency type" [options]="currency_type"></becki-form-select>
                            <becki-form-select *ngIf="selectedTariff.required_payment_method" [control]="form.controls.payment_method" label="Payment method" [options]="payment_method"></becki-form-select>
                            <becki-form-select *ngIf="selectedTariff.required_payment_mode" [control]="form.controls.payment_mode" label="Payment mode" [options]="payment_mode"></becki-form-select>
                            <becki-form-input [control]="form.controls.product_individual_name" label="Product name (Your unique name for this tarrif)"></becki-form-input>
                            <!-- uloží z prokliku? -->
                            <becki-form-input [control]="form.controls.street" label="Street"></becki-form-input>
                            <becki-form-input [control]="form.controls.street_number" label="Street number"></becki-form-input>
                            <!--     <becki-form-input [control]="form.controls.tariff_type" label="tariff type"></becki-form-input>   uloží z prokliku -->
                            <becki-form-input [control]="form.controls.zip_code" label="Zip code"></becki-form-input>
                        </div>

                        <div *ngIf="selectedTariff.company_details_required" class="col-md-6">
                            <p>
                            <h2>Company info</h2>

                            <becki-form-input  [control]="form.controls.company_authorized_email"
                                              [type]="email" label="Company authorized email"></becki-form-input>
                            <becki-form-input  [control]="form.controls.company_authorized_phone"
                                              [type]="number" label="Company authorized phone"></becki-form-input>
                            <becki-form-input  [control]="form.controls.company_invoice_email"
                                              [type]="email" label="Company invoice email"></becki-form-input>
                            <becki-form-input  [control]="form.controls.company_name"
                                              label="Company name"></becki-form-input>
                            <becki-form-input  [control]="form.controls.company_web"
                                              label="Company web"></becki-form-input>
                            <becki-form-input  [control]="form.controls.registration_no"
                                              label="Registration no"></becki-form-input>
                            <becki-form-input  [control]="form.controls.vat_number"
                                              label="Vat number"></becki-form-input> <!-- //? CZ28496639 -->
                        </div>


                        <div class="form-actions">
                            <div class="row">
                                <div class=" col-md-9">
                                    <button type="button" class="btn green btn-outline"
                                            [disabled]="!form || !form.valid"
                                            (click)="stepClick(3,false)">Continue
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </form>

    </div>


    <div *ngIf="step===3">
        <div class="portlet light portlet-fit bordered">
            <div class="portlet-title">
                <div class="caption">
                    <i class=" icon-layers font-green"></i>
                    <span class="caption-subject font-green bold uppercase">Choose an additional expansions</span>
                </div>
            </div>
            <div class="portlet-body">
                <div class="pricing-content-1">
                    <div *ngIf="selectedTariff.extensionses">
                        <div *ngIf="selectedTariff.extensionses.length==0">
                            <h3 class="text-center">There is no additional packages, click continue</h3>
                        </div>
                    </div>
                    <div class="row">
                        <div *ngFor="let package of selectedTariff.extensionses" class="col-md-3">
                            <div [class.border-red-mint]="selectedExtensions.indexOf(package) > -1"
                                 class="price-column-container border-active">
                                <div class="price-table-head bg-{{package.color | lowercase}}">
                                    <h2 class="no-margin">{{package.name}}</h2>
                                </div>
                                <div class="arrow-down border-top-{{package.color | lowercase}}"></div>
                                <div class="price-table-pricing">
                                    <h4 style="margin: 0 10px; color: gray;" class="pull-right">{{package.price.USD}}<span class="becki-payment-secondary price-sign" >$</span></h4>
                                    <h4 style="margin: 0 10px;color: gray;" class="pull-left">{{package.price.CZK}}<span class="becki-payment-secondary price-sign">CZK</span></h4>
                                    <h3 style="clear: both;padding-top: 10px;"><span class="price-sign">€</span>{{package.price.EUR}}</h3> <!-- TODO price selector--> <!-- TODO price selector-->
                                    <!-- TODO ceny se budou měnit dle jazykové mutace-->
                                    <p>per month</p>
                                </div>
                                <div class="price-table-content">
                                    <div *ngFor="let label of package.labels" class="row mobile-padding">
                                        <div class="col-xs-3 text-right mobile-padding">
                                            <i class="fa {{label.icon| lowercase}}"></i>
                                        </div>
                                        <div class="col-xs-9 text-left mobile-padding">{{label.label}}</div>
                                        <!--(mouseenter)="" (mouseleave)=""-->
                                    </div>

                                </div>
                                <div class="arrow-down arrow-grey"></div>
                                <div class="price-table-footer col-md-12">
                                    <button type="button" (click)="addExtension(package)"
                                            class="btn grey-salsa btn-outline bold uppercase price-button">select
                                    </button>
                                </div>
                            </div>
                        </div>
                        <div class="form-actions">
                            <div class="row">
                                <div class=" col-md-12">
                                    <button type="button" class="btn green btn-outline center-block" (click)="stepClick(4,false)">
                                        Continue
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="step===4">

        <template ng-if="serverResponse">
            <div *ngIf="serverResponse.gw_url">Please pay to complete your tarif registration, click
                <a href="serverResponse.gw_url">here</a></div>
            <div *ngIf="!serverResponse.gw_url">Done!</div>
        </template>

        <div class="row">
            <div class="col-md-6 col-sm-12">
                <div class="portlet yellow-crusta box">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class="fa fa-id-card"></i>Customer Info</div>
                        <div class="actions">
                            <a (click)="stepClick(2,false)" class="btn btn-default btn-sm">
                                <i class="fa font-white fa-pencil"></i> Edit </a>
                        </div>
                    </div>
                    <div class="portlet-body">

                        <div class="table-scrollable table-scrollable-borderless">
                            <table class="table table-hover table-light">
                                <tbody>
                                <tr>
                                    <td> City: </td>
                                    <td> {{form.controls["city"].value}} </td>
                                </tr>
                                <tr>
                                    <td> Country: </td>
                                    <td> {{form.controls["country"].value}} </td>
                                </tr>

                                <tr>
                                    <td> Currency type: </td>
                                    <td> {{form.controls["currency_type"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['payment_method']">
                                    <td> Payment method: </td>
                                    <td> {{form.controls["payment_method"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['payment_mode']">
                                    <td> Payment mode: </td>
                                    <td> {{form.controls["payment_mode"].value}} </td>
                                </tr>
                                <tr>
                                    <td> Product individual name: </td>
                                    <td> {{form.controls["product_individual_name"].value}} </td>
                                </tr>
                                <tr>
                                    <td> Street number: </td>
                                    <td> {{form.controls["street_number"].value}} </td>
                                </tr>
                                <tr>
                                    <td> Zip code: </td>
                                    <td> {{form.controls["zip_code"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['company_authorized_email']">
                                    <td> Company authorized email: </td>
                                    <td> {{form.controls["company_authorized_email"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['company_authorized_phone']">
                                    <td> Company authorized phone: </td>
                                    <td> {{form.controls["company_authorized_phone"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['company_invoice_email']">
                                    <td> Company invoice email: </td>
                                    <td> {{form.controls["company_invoice_email"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['company_name']">
                                    <td> Company name: </td>
                                    <td> {{form.controls["company_name"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['company_web']">
                                    <td> Company web: </td>
                                    <td> {{form.controls["company_web"].value}} </td>
                                </tr>
                                <tr  *ngIf="form.controls['registration_no']">
                                    <td> Registration no.: </td>
                                    <td> {{form.controls["registration_no"].value}} </td>
                                </tr>
                                <tr *ngIf="form.controls['vat_number']">
                                    <td> Vat number: </td>
                                    <td> {{form.controls["vat_number"].value}} </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>




                    </div>
                </div>
            </div>
            <div class="col-md-6 col-sm-12">
                <div class="row">
                <div class="col-sm-12">
                    <div class="portlet blue-hoki box">
                        <div class="portlet-title">
                            <div class="caption">
                                <i class="fa fa-database"></i> Tarrif </div>
                        </div>
                        <div class="portlet-body">
                            <table class="table table-hover">
                                <thead>
                                <tr>
                                    <th> Tarrif </th>
                                    <th> Description </th>
                                    <th> Price </th>
                                </tr>
                                </thead>
                                <tbody>
                                <tr>
                                    <td> {{selectedTariff.tariff_name}} </td>
                                    <td> {{selectedTariff.tariff_description}}  </td>
                                    <td> {{selectedTariff.price.EUR}}</td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                </div>
            <div class="row">
                <div class="col-sm-12">
                    <div class="portlet green-meadow box">
                        <div class="portlet-title">
                            <div class="caption">
                                 <i class="fa fa-globe"></i> Aditional features </div>
                           </div>
                           <div class="portlet-body">
                               <table *ngIf="selectedExtensions&&selectedExtensions.length>0" class="table table-hover">
                                   <thead>
                                   <tr>
                                       <th> Package </th>
                                       <th> Description </th>
                                       <th> Price </th>
                                       <th>  </th>
                                   </tr>
                                   </thead>
                                   <tbody *ngFor="let package of selectedExtensions">
                                   <tr>
                                       <td>{{package.name}}</td>
                                       <td>{{package.description}}</td>
                                       <td>{{package.price.EUR}}</td>
                                       <td> <i (click)="addExtension(package)" class="font-red fa fa-trash fa-2x"></i></td>
                                   </tr>
                                   </tbody>
                               </table>
                               <h3 class="center-block" *ngIf="selectedExtensions&&selectedExtensions.length==0">You dont choose any Aditional features.</h3>
                        </div>
                    </div>
                </div>
            </div>

            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <div class="portlet bg-purple-sharp box">
                    <div class="portlet-title">
                        <div class="caption">
                            <i class=" font-white fa fa-shopping-basket"></i> Cost </div>
                    </div>
                <div class="portlet-body">
                <table class="table table-hover">
                    <thead>
                    <tr>
                        <th> Item </th>
                        <th> price </th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td> {{selectedTariff.tariff_name}} </td>
                        <td> {{selectedTariff.price.EUR}}  </td> <!-- TODO price selector-->
                    </tr>
                    </tbody>
                    <tbody *ngFor="let package of selectedExtensions">
                    <tr>
                        <td> {{package.name}} </td>
                        <td> {{package.price.EUR}}  </td> <!-- TODO price selector-->
                    </tr>
                    </tbody>
                    <thead>
                    <tr>
                        <th> Cost: </th>
                        <th> {{getWholePrice()}} </th> <!-- TODO vymyslet lépe? udělat si promněnou na celkový součet? -->
                    </tr>
                    </thead>
                </table>
            </div>
            </div>
            </div>
        </div>



            <button type="button" (click)="onSubmitClick()" class="btn grey-salsa btn-outline center bold uppercase price-button">Confirm</button>
        </div>
</layout-main>