<!--
  ~ Â© 2015-2016 Becki Authors. See the AUTHORS file found in the top-level
  ~ directory of this distribution.
  -->

<div class="modal fade" tabindex="-1" data-bind-class.in="modal" data-bind-style.display="modal ? 'block' : 'none'" data-bind-style.background-color="modal ? 'rgba(0,0,0,0.5)' : 'initial'">
  <div class="modal-dialog">
    <div class="modal-content" data-bind-ngSwitch="getModalType()">
      <template data-bind-ngSwitchCase="'selection'">
        <div class="modal-header">
          <button type="button" class="close" data-on-click="onModalCloseClick(false, $event)"><span>&times;</span></button>
          <h4 class="modal-title">Select From the List</h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>
              <span class="glyphicon glyphicon-list"></span>
              List
            </label>
            <select class="form-control" required data-bindon-ngModel="modal.selection" name="list">
              <option template="ngFor let option of modal.options">
                {{option}}
              </option>
            </select>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-on-click="onModalCloseClick(false, $event)">
            Cancel
          </button>
          <button type="button" class="btn btn-primary" data-on-click="onModalCloseClick(true, $event)">
            OK
          </button>
        </div>
      </template>
      <template data-bind-ngSwitchCase="'removal'">
        <div class="modal-header">
          <button type="button" class="close" data-on-click="onModalCloseClick(false, $event)"><span>&times;</span></button>
          <h4 class="modal-title">Confirm an irreversible action</h4>
        </div>
        <div class="modal-body">
          Do you really want to remove <strong>{{modal.name}}</strong>?
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-on-click="onModalCloseClick(false, $event)">
            No
          </button>
          <button type="button" class="btn btn-danger" data-on-click="onModalCloseClick(true, $event)">
            Yes
          </button>
        </div>
      </template>
      <template data-bind-ngSwitchCase="'filename'">
        <div class="modal-header">
          <button type="button" class="close" data-on-click="onModalCloseClick(false, $event)"><span>&times;</span></button>
          <h4 class="modal-title">Enter the New File Name</h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label>
              <span class="glyphicon glyphicon-hdd"></span>
              File name
            </label>
            <input class="form-control" data-bindon-ngModel="modal.name" name="name">
            <span class="help-block">Use the "{{modal.separator}}" character as a path separator. Nonexistent directories will be created for you.</span>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-on-click="onModalCloseClick(false, $event)">
            Cancel
          </button>
          <button type="button" class="btn btn-primary" data-on-click="onModalCloseClick(true, $event)">
            OK
          </button>
        </div>
      </template>
      <template data-bind-ngSwitchCase="'widget'">
        <div data-bind-ngSwitch="modal?.readonly">
          <div class="modal-header">
            <button type="button" class="close" data-on-click="onModalCloseClick(false, $event)"><span>&times;</span></button>
            <h4 class="modal-title">
              <template data-bind-ngSwitchCase="true">
                Review the Widget Configuration
              </template>
              <template data-bind-ngSwitchCase="false">
                Edit the Widget
              </template>
            </h4>
          </div>
          <div class="modal-body">
            <div class="form-group" template="ngFor let property of modal?.widget?.configProperties">
              <label>
                <template data-bind-ngSwitchCase="false">
                  <span class="glyphicon glyphicon-pencil"></span>
                </template>
                {{property.displayName}}
              </label>
              <template data-bind-ngSwitchCase="true">
                <p class="form-control-static" data-bind-ngSwitch="getWidgetPropertyType(property)">
                  <template data-bind-ngSwitchCase="'bool'">
                    {{property.value ? 'yes' : 'no'}}
                  </template>
                  <template ngSwitchDefault>
                    {{property.value}}
                  </template>
                </p>
              </template>
              <template data-bind-ngSwitchCase="false">
                <div data-bind-ngSwitch="getWidgetPropertyType(property)">
                  <template data-bind-ngSwitchCase="'int'">
                    <input class="form-control" type="number" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'float'">
                    <input class="form-control" type="number" step="0.01" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'text'">
                    <input class="form-control" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'bool'">
                    <input type="checkbox" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                </div>
              </template>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-on-click="onModalCloseClick(false, $event)">
              Close
            </button>
            <template data-bind-ngIf="!modal?.readonly">
              <button type="button" class="btn btn-primary" data-on-click="onModalCloseClick(true, $event)">
                Edit
              </button>
            </template>
          </div>
        </div>
      </template>
      <template data-bind-ngSwitchCase="'block'">
        <div data-bind-ngSwitch="modal?.readonly">
          <div class="modal-header">
            <button type="button" class="close" data-on-click="onModalCloseClick(false, $event)"><span>&times;</span></button>
            <h4 class="modal-title">
              <template data-bind-ngSwitchCase="true">
                Review the "{{modal?.block?.id}}" Block Configuration
              </template>
              <template data-bind-ngSwitchCase="false">
                Edit the "{{modal?.block?.id}}" Block
              </template>
            </h4>
          </div>
          <div class="modal-body">
            <div class="form-group" template="ngFor let property of modal?.block?.getConfigProperties()">
              <label>
                <template data-bind-ngSwitchCase="false">
                  <span class="glyphicon glyphicon-pencil"></span>
                </template>
                {{property.displayName}}
              </label>
              <template data-bind-ngSwitchCase="true">
                <p class="form-control-static" data-bind-ngSwitch="getBlockPropertyType(property)">
                  <template data-bind-ngSwitchCase="'bool'">
                    {{property.value ? 'yes' : 'no'}}
                  </template>
                  <template data-bind-ngSwitchCase="'javascript'">
                    <pre>{{property.value}}</pre>
                  </template>
                  <template ngSwitchDefault>
                    {{property.value}}
                  </template>
                </p>
              </template>
              <template data-bind-ngSwitchCase="false">
                <div data-bind-ngSwitch="getBlockPropertyType(property)">
                  <template data-bind-ngSwitchCase="'int'">
                    <input class="form-control" type="number" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'float'">
                    <input class="form-control" type="number" step="0.1" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'text'">
                    <input class="form-control" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'bool'">
                    <input type="checkbox" data-bindon-ngModel="property.value" name="property{{property.id}}">
                  </template>
                  <template data-bind-ngSwitchCase="'javascript'">
                    <div data-bindon-fieldCode="property.value" data-bind-mode="'ace/mode/javascript'">
                      <div class="spinner"></div>
                    </div>
                  </template>
                </div>
              </template>
            </div>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-default" data-on-click="onModalCloseClick(false, $event)">
              Close
            </button>
            <template data-bind-ngIf="!modal?.readonly">
              <button type="button" class="btn btn-primary" data-on-click="onModalCloseClick(true, $event)">
                Edit
              </button>
            </template>
          </div>
        </div>
      </template>
    </div>
  </div>
</div>
<template data-bind-ngIf="router.navigating">
  <div class="overlay">
    <div class="spinner spinner-lg"></div>
  </div>
</template>
<template data-bind-ngIf="getNotification()">
  <div class="toast-pf toast-pf-top-right alert alert-{{getNotification().type}} alert-dismissable">
    <button type="button" class="close" data-on-click="onNotificationCloseClick($event)">
      <span class="pficon pficon-close"></span>
    </button>
    <span class="pficon pficon-{{getNotification().icon}}"></span>
    {{getNotification().body}}
  </div>
</template>
<router-outlet></router-outlet>
