<!--
  ~ Â© 2015-2016 Becki Authors. See the AUTHORS file found in the top-level
  ~ directory of this distribution.
  -->

<div data-bind-layout="heading" data-bind-breadcrumbs="breadcrumbs">
  <div class="row">
    <div class="col-xs-12 col-sm-9">
      <div class="media" template="ngFor #item of items">
        <div class="media-left">
          <div class="btn-group-vertical">
            <button class="btn btn-default" type="button" data-on-click="onPlusClick(item.id, $event)">
              <span class="glyphicon glyphicon-thumbs-up"></span>
            </button>
            <div class="h2" style="margin: 6px 12px;text-align: center;">
              {{item.likes}}
            </div>
            <button class="btn btn-default" type="button" data-on-click="onMinusClick(item.id, $event)">
              <span class="glyphicon glyphicon-thumbs-down"></span>
            </button>
          </div>
        </div>
        <div class="media-body">
          <div class="panel panel-default">
            <div class="panel-body">
              <template data-bind-ng-if="item.editing">
                <form class="clearfix" data-on-submit="onItemEditingSubmit(item, $event)">
                  <template data-bind-ng-if="item.hasOwnProperty('typeField')">
                    <div class="form-group">
                      <label>
                        <span class="glyphicon glyphicon-list"></span>
                        Type
                      </label>
                      <select class="form-control" required data-bindon-ng-model="item.typeField">
                        <option value="">Select type...</option>
                        <option data-bind-value="type.id" template="ngFor #type of types">
                          {{type.type}}
                        </option>
                      </select>
                    </div>
                  </template>
                  <template data-bind-ng-if="item.hasOwnProperty('titleField')">
                    <div class="form-group">
                      <label>
                        <span class="glyphicon glyphicon-pencil"></span>
                        Title
                      </label>
                      <input class="form-control" required data-bindon-ng-model="item.titleField">
                    </div>
                  </template>
                  <div class="form-group">
                    <label>
                      <span class="glyphicon glyphicon-pencil"></span>
                      Body
                    </label>
                    <div data-bindon-field-issue-body="item.bodyField" data-bind-required="true">
                      <div class="spinner"></div>
                    </div>
                  </div>
                  <div class="pull-right">
                    <button class="btn btn-danger" type="button" data-on-click="onItemEditingCancelClick(item, $event)">
                      Cancel
                    </button>
                    <button class="btn btn-primary" type="submit">
                      Update
                    </button>
                  </div>
                </form>
              </template>
              <template data-bind-ng-if="item.importing">
                <form class="clearfix" data-on-submit="onItemImportingSubmit(item, $event)">
                  <div class="form-group">
                    <label>
                      <span class="glyphicon glyphicon-list"></span>
                      Project
                    </label>
                    <select class="form-control" required data-bindon-ng-model="item.programProjectField" data-on-ng-model-change="item.programNameField = ''">
                      <option value="">Select name...</option>
                      <option data-bind-value="project.id" template="ngFor #project of projects">
                        {{project.project_name}}
                      </option>
                    </select>
                  </div>
                  <template data-bind-ng-if="item.programProjectField">
                    <div class="form-group">
                      <label>
                        <span class="glyphicon glyphicon-pencil"></span>
                        Name
                      </label>
                      <input class="form-control" required data-bindon-ng-model="item.programNameField" data-bind-custom-validator="validateHomerProgramName(item.programNameField, item.programProjectField)" data-message="This name is used already. Please choose another one.">
                    </div>
                    <div class="form-group">
                      <label>
                        <span class="glyphicon glyphicon-pencil"></span>
                        Description
                      </label>
                      <textarea class="form-control" data-bindon-ng-model="item.programDescriptionField"></textarea>
                    </div>
                    <div class="form-group">
                      <label>
                        <span class="glyphicon glyphicon-console"></span>
                        Code
                      </label>
                      <div data-bindon-field-homer-program="item.programCodeField">
                        <div class="spinner"></div>
                      </div>
                    </div>
                  </template>
                  <div class="pull-right">
                    <button class="btn btn-danger" type="button" data-on-click="onItemImportingCancelClick(item, $event)">
                      Cancel
                    </button>
                    <button class="btn btn-primary" type="submit">
                      Import
                    </button>
                  </div>
                </form>
              </template>
              <template data-bind-ng-if="item.removing">
                <div class="pull-right">
                  <button class="btn btn-danger" type="button" data-on-click="onItemRemovingYesClick(item, $event)">Yes</button>
                  <button class="btn btn-default" type="button" data-on-click="onItemRemovingNoClick(item, $event)">No</button>
                </div>
                Do you really want to remove this?
              </template>
              <template data-bind-ng-if="!item.editing && !item.importing && !item.removing">
                <div class="dropdown dropdown-kebab-pf pull-right">
                  <button class="btn btn-link dropdown-toggle" type="button">
                    <span class="fa fa-ellipsis-v"></span>
                  </button>
                  <ul class="dropdown-menu dropdown-menu-right">
                    <template data-bind-ng-if="item.programCodeField != null">
                      <li><a data-on-click="onItemImportClick(item, $event)" style="cursor: pointer">Import</a></li>
                    </template>
                    <li><a data-on-click="onItemEditClick(item, $event)" style="cursor: pointer">Edit</a></li>
                    <li><a data-on-click="onItemRemoveClick(item, $event)" style="cursor: pointer">Remove</a></li>
                  </ul>
                </div>
                <div data-bindon-field-issue-body="item.body" data-bind-readonly="true">
                  <div class="spinner"></div>
                </div>

                <p class="pull-right">{{item.date}}</p>
              </template>
            </div>
            <div class="panel-footer">
              <div template="ngFor #comment of item.comments">
                <div class="media" style="overflow: visible">
                  <div class="media-left">
                    <img class="media-object" src="...">
                  </div>
                  <div class="media-body" style="overflow: visible">
                    <template data-bind-ng-if="comment.editing">
                      <form class="clearfix" data-on-submit="onCommentEditingSubmit(comment, $event)">
                        <div class="form-group">
                          <label>
                            <span class="glyphicon glyphicon-comment"></span>
                            Comment
                          </label>
                          <textarea class="form-control" required data-bindon-ng-model="comment.bodyField"></textarea>
                        </div>
                        <div class="pull-right">
                          <button class="btn btn-danger" type="button" data-on-click="onCommentEditingCancelClick(comment, $event)">
                            Cancel
                          </button>
                          <button class="btn btn-primary" type="submit">Update
                          </button>
                        </div>
                      </form>
                    </template>
                    <template data-bind-ng-if="comment.removing">
                      <div class="pull-right">
                        <button class="btn btn-danger" type="button" data-on-click="onCommentRemovingYesClick(comment, $event)">Yes</button>
                        <button class="btn btn-default" type="button" data-on-click="onCommentRemovingNoClick(comment, $event)">No</button>
                      </div>
                      Do you really want to remove this comment?
                    </template>
                    <template data-bind-ng-if="!comment.editing && !comment.removing">
                      <div class="media-heading" style="font-weight: bold;">
                        Author - {{comment.date}}
                        <div class="pull-right">
                          <div class="btn-group btn-group-xs">
                            <button class="btn btn-default" type="button" data-on-click="onPlusClick(comment.id, $event)">
                              <span class="glyphicon glyphicon-thumbs-up"></span>
                            </button>
                            <div style="float: left;padding: 1px 5px;">
                              {{comment.likes}}
                            </div>
                            <button class="btn btn-default" type="button" data-on-click="onMinusClick(comment.id, $event)">
                              <span class="glyphicon glyphicon-thumbs-down"></span>
                            </button>
                          </div>
                          <div class="dropdown dropdown-kebab-pf pull-right" style="margin-left: 10px">
                            <button class="btn btn-link dropdown-toggle" type="button">
                              <span class="fa fa-ellipsis-v"></span>
                            </button>
                            <ul class="dropdown-menu dropdown-menu-right">
                              <li><a data-on-click="onCommentEditClick(comment, $event)" style="cursor: pointer">Edit</a></li>
                              <li><a data-on-click="onCommentRemoveClick(comment, $event)" style="cursor: pointer">Remove</a></li>
                            </ul>
                          </div>
                        </div>
                      </div>
                      {{comment.body}}
                    </template>
                  </div>
                </div>
                <hr>
              </div>
              <div class="media">
                <div class="media-left">
                  <img class="media-object" src="...">
                </div>
                <form class="media-body" data-on-submit="onCommentCreationSubmit(item, $event)">
                  <div class="input-group">
                    <input class="form-control" type="text" required data-bindon-ng-model="item.commentField">
                    <span class="input-group-btn">
                      <button class="btn btn-primary" type="submit">Comment</button>
                    </span>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-3">
      <div>
        <div class="pull-right">
          <button type="button" class="btn btn-default" data-on-click="onRelatedAddClick($event)">Add</button>
        </div>
        <h2>Related</h2>
      </div>
      <div data-bind-list-group="related" data-on-add-click="onRelatedAddClick($event)" data-on-remove-click="onRelatedRemoveClick($event)">
        <div class="spinner"></div>
      </div>

      <div>
        <div class="pull-right">
          <button type="button" class="btn btn-default" data-on-click="onTagAddClick($event)">Add</button>
        </div>
        <h2>Tags</h2>
      </div>
      <div data-bind-list-group="tags" data-on-add-click="onTagAddClick($event)" data-on-remove-click="onTagRemoveClick($event)">
        <div class="spinner"></div>
      </div>

      <div>
        <div class="pull-right">
          <button type="button" class="btn btn-default" data-on-click="onConfirmationAddClick($event)">Add</button>
        </div>
        <h2>Confirmations</h2>
      </div>
      <div data-bind-list-group="confirmations" data-on-add-click="onConfirmationAddClick($event)" data-on-remove-click="onConfirmationRemoveClick($event)">
        <div class="spinner"></div>
      </div>
    </div>
  </div>
  <div class="panel panel-default">
    <form class="panel-body clearfix" data-on-submit="onAnswerCreationSubmit($event)">
      <div class="form-group">
        <label>
          <span class="glyphicon glyphicon-pencil"></span>
          New Answer
        </label>
        <div data-bindon-field-issue-body="answerBodyField" data-bind-required="true">
          <div class="spinner"></div>
        </div>
      </div>
      <button class="btn btn-primary pull-right" type="submit">Create</button>
    </form>
  </div>
</div>
